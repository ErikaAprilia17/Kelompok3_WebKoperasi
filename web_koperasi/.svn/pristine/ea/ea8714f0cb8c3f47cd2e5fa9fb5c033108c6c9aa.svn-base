<?php
class data_pinjaman extends CI_Controller {

function __construct(){
		parent::__construct();		
		$this->load->model('m_data');
 
	}

	public function index()
	{
		$data = array(
			'title' => 'Data Pinjaman',
			'page' => 'admin/pinjaman/v_data_pinjaman',
			'data_pinjam' => $this->db->get('data_pinjaman')->result(),
			
		);
		$this->load->view('admin/layout/template',$data);
	}

	function edit($id){
		$data = array(
			'title' => 'Edit Data Pinjaman',
			'page' => 'admin/pinjaman/v_edit_pinjaman',
			'data_pinjam' => $this->db->where('id',$id)->get('data_pinjaman')->row(),
			
		);
		$this->load->view('admin/layout/template',$data);
	}

	function update(){
		$id = $this->input->post('id');
		$kode = $this->input->post('kode');
		$tanggal_peminjaman = $this->input->post('tanggal_peminjaman');
		$nama_anggota = $this->input->post('nama_anggota');
		$hitungan = $this->input->post('hitungan');
		$total_tagihan = $this->input->post('total_tagihan');
		$lunas = $this->input->post('lunas');
		$user = $this->input->post('user');
		$aksi = $this->input->post('aksi');


		$data = array(
			'kode' => $kode,
			'tanggal_peminjaman' => $tanggal_peminjaman,
			'nama_anggota' => $nama_anggota,
			'hitungan' => $hitungan,
			'total_tagihan' => $total_tagihan,
			'lunas' => $lunas,
			'user' => $user,
			'aksi' => $aksi,
		);

		$where = array(
			'id' => $id
		);

		$this->db->where($where);
		$this->db->update('data_pinjaman',$data);
		$this->session->set_flashdata('success_tambah','a');
		redirect('admin/pinjaman/data_pinjaman');
	}

	function tambah(){
		$data = array(
			'title' => 'Tambah Data Pinjaman',
			'page' => 'admin/pinjaman/v_tambah_pinjaman',
			'nama_anggota'=> $this->db->get('data_anggota')->result(),
			'nama_barang' => $this->db->get('data_barang')->result(),
			'lama_angsuran' => $this->db->get('lama_angsuran')->result(),
			'data_kas' => $this->db->get('data_kas')->result(),
			'bunga' => $this->db->get('suku_bunga')->result(),
		);
		$this->load->view('admin/layout/template',$data);
	}
function insert(){
		$kode = $this->input->post('kode');
		$tanggal_peminjaman = $this->input->post('tanggal_peminjaman');
		$id_anggota = $this->input->post('id_anggota');
		$id_barang = $this->input->post('id_barang');
		$id_kas = $this->input->post('id_kas');
		$lama_angsuran = $this->input->post('lama_angsuran');
		$hitungan = $this->input->post('hitungan');
		$total_tagihan = $this->input->post('total_tagihan');
		$lunas = $this->input->post('lunas');
		$user = $this->input->post('user');
		$aksi = $this->input->post('aksi');
		$bunga = $this->input->post('bunga');

		$data = array(
			'kode' => $kode,
			'tanggal_peminjaman' => $tanggal_peminjaman,
			'id_anggota' => $id_anggota,
			'id_kas' => $id_kas,
			'hitungan' => $hitungan,
			'total_tagihan' => $total_tagihan,
			'lunas' => $lunas,
			'user' => $user,
			'aksi' => $aksi,
			'id_barang' => $id_barang,
			'bunga' => $bunga,
		);

		$this->db->insert('data_pinjaman',$data);
		$this->session->set_flashdata('success_tambah','a');
		redirect('admin/pinjaman/data_pinjaman');
	}

	 function hapus($id){
 
  		$this->db->where('id', $id);
  		$this->db->delete('data_pinjaman');
  		$this->session->set_flashdata('success_hapus','a'); 
  		redirect('admin/pinjaman/data_pinjaman');
 }

}
	 

